// ====================================================================================
// DÉBUT DE LA BIBLIOTHÈQUE QRCODE.MIN.JS
// Il est impératif que ce bloc de code soit au tout début du fichier.
// ====================================================================================

var QRCode=function(){"use strict";var t=function(){function t(t,e){if(this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],"string"==typeof arguments[2]){this.dataList.push(arguments[2]);var r=arguments[3];r&&(this.errorCorrectLevel=r)}}t.prototype={addData:function(t){this.dataList.push(t),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,r){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[n]=new Array(this.moduleCount);this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,r),7<=this.typeNumber&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,r)},setupPositionProbePattern:function(t,e){for(var r=-1;r<=7;r++)if(!(t+r<=-1||this.moduleCount<=t+r))for(var n=-1;n<=7;n++)e+n<=-1||this.moduleCount<=e+n||(0<=r&&r<=6&&(0==n||6==n)||0<=n&&n<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=n&&n<=4?this.modules[t+r][e+n]=!0:this.modules[t+r][e+n]=!1)},getBestMaskPattern:function(){for(var t=0,e=0,r=0;r<8;r++){this.makeImpl(!0,r);var n=o.getLostPoint(this);(0==r||t>n)&&(t=n,e=r)}return e},createMovieClip:function(t,e,r){var n=t.createEmptyMovieClip(e,r),i=1;this.make();for(var o=0;o<this.moduleCount;o++){var a=o*i;for(var s=0;s<this.moduleCount;s++){var u=s*i,h=this.modules[o][s];h&&(n.beginFill(0,100),n.moveTo(u,a),n.lineTo(u+i,a),n.lineTo(u+i,a+i),n.lineTo(u,a+i),n.endFill())}}return n},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=o.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var n=t[e],i=t[r];if(null==this.modules[n][i])for(var a=-2;a<=2;a++)for(var s=-2;s<=2;s++)-2==a||2==a||-2==s||2==s||0==a&&0==s?this.modules[n+a][i+s]=!0:this.modules[n+a][i+s]=!1}},setupTypeNumber:function(t){for(var e=o.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var n=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=n}for(r=0;r<18;r++){n=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=n}},setupTypeInfo:function(t,e){for(var r=this.errorCorrectLevel<<3|e,n=o.getBCHTypeInfo(r),i=0;i<15;i++){var a=!t&&1==(n>>i&1);i<6?this.modules[i][8]=a:i<8?this.modules[i+1][8]=a:this.modules[this.moduleCount-15+i][8]=a}for(i=0;i<15;i++){a=!t&&1==(n>>i&1);i<8?this.modules[8][this.moduleCount-i-1]=a:i<9?this.modules[8][15-i-1+1]=a:this.modules[8][15-i-1]=a}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,n=this.moduleCount-1,i=7,a=0,s=this.moduleCount-1;0<s;s-=2)for(6==s&&s--;;){for(var u=0;u<2;u++){if(null==this.modules[n][s-u]){var h=!1;a<t.length&&(h=1==(t[a]>>>i&1));o.getMask(e,n,s-u)&&(h=!h),this.modules[n][s-u]=h,i--,-1==i&&(a++,i=7)}}if((n+=r)<0||this.moduleCount<=n){n-=r,r=-r;break}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,r,n){for(var i=a.getRSBlocks(e,r),s=new u,c=0;c<n.length;c++){var l=n[c];s.put(o.stringToBytes(l).length,8),s.putBytes(o.stringToBytes(l))}var d=0;for(c=0;c<i.length;c++)d+=i[c].dataCount;if(s.getLengthInBits()>8*d)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*d+")");for(s.getLengthInBits()+4<=8*d&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;!(s.getLengthInBits()>=8*d);){if(s.put(t.PAD0,8),s.getLengthInBits()>=8*d)break;s.put(t.PAD1,8)}return t.createBytes(s,i)},t.createBytes=function(t,e){for(var r=0,n=0,i=0,a=new Array(e.length),s=new Array(e.length),u=0;u<e.length;u++){var h=e[u].dataCount,f=e[u].totalCount-h;n=Math.max(n,h),i=Math.max(i,f),a[u]=new Array(h);for(var g=0;g<a[u].length;g++)a[u][g]=255&t.buffer[g+r];r+=h;var v=o.getErrorCorrectPolynomial(f),p=new c(a[u],v.getLength()-1).mod(v);s[u]=new Array(v.getLength()-1);for(g=0;g<s[u].length;g++){var m=g+p.getLength()-s[u].length;s[u][g]=0<=m?p.get(m):0}}var w=0;for(g=0;g<e.length;g++)w+=e[g].totalCount;var E=new Array(w),b=0;for(g=0;g<n;g++)for(u=0;u<e.length;u++)g<a[u].length&&(E[b++]=a[u][g]);for(g=0;g<i;g++)for(u=0;u<e.length;u++)g<s[u].length&&(E[b++]=s[u][g]);return E};var e={L:1,M:0,Q:3,H:2};function r(){}r.prototype={get:function(t){var e=this.string.charCodeAt(t);if(e<128)return[e];var r=this.string.charCodeAt(t+1);if(e<2048)return[192|e>>6,128|63&e];if(e<55296||57343<e)return[224|e>>12,128|e>>6&63,128|63&e];if(55296<=e&&e<=56319&&56320<=r&&r<=57343){var n=65536+((1023&e)<<10|1023&r);return[240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n]}throw new Error("Invalid character: "+e)},getLength:function(){return this.string.length}},r.stringToBytes=function(t){return(new r).string=t,function(t){for(var e=[],r=0;r<t.getLength();r++)for(var n=t.get(r),i=0;i<n.length;i++)e.push(n[i]);return e}(this)};var n={};n.glog=function(t){if(t<1)throw new Error("glog(" + t + ")");return n.LOG_TABLE[t]},n.gexp=function(t){for(;t<0;)t+=255;for(;256<=t;)t-=255;return n.EXP_TABLE[t]},n.EXP_TABLE=new Array(256),n.LOG_TABLE=new Array(256);for(var i=0;i<8;i++)n.EXP_TABLE[i]=1<<i;for(i=8;i<256;i++)n.EXP_TABLE[i]=n.EXP_TABLE[i-4]^n.EXP_TABLE[i-5]^n.EXP_TABLE[i-6]^n.EXP_TABLE[i-8];for(i=0;i<255;i++)n.LOG_TABLE[n.EXP_TABLE[i]]=i;var o={};o.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],o.G15=1335,o.G18=7972,o.G15_MASK=21522,o.getBCHTypeInfo=function(t){for(var e=t<<10;o.getBCHDigit(e)-o.getBCHDigit(o.G15)>=0;)e^=o.G15<<o.getBCHDigit(e)-o.getBCHDigit(o.G15);return(t<<10|e)^o.G15_MASK},o.getBCHTypeNumber=function(t){for(var e=t<<12;o.getBCHDigit(e)-o.getBCHDigit(o.G18)>=0;)e^=o.G18<<o.getBCHDigit(e)-o.getBCHDigit(o.G18);return t<<12|e},o.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>=1;return e},o.getPatternPosition=function(t){return o.PATTERN_POSITION_TABLE[t-1]},o.getMask=function(t,e,r){switch(t){case 0:return(e+r)%2==0;case 1:return e%2==0;case 2:return r%3==0;case 3:return(e+r)%3==0;case 4:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case 5:return e*r%2+e*r%3==0;case 6:return(e*r%2+e*r%3)%2==0;case 7:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},o.getErrorCorrectPolynomial=function(t){for(var e=new c([1],0),r=0;r<t;r++)e=e.multiply(new c([1,n.gexp(r)],0));return e},o.getLengthInBits=function(t,e){if(1<=e&&e<10)switch(t){case 1:return 10;case 2:return 9;case 3:return 8;case 4:return 8;case 5:return 7;case 6:return 7;case 7:return 6;case 8:return 6;case 9:return 5;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case 1:return 12;case 2:return 11;case 3:return 16;case 4:return 10;case 5:return 9;case 6:return 8;case 7:return 8;case 8:return 7;case 9:return 7;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case 1:return 14;case 2:return 13;case 3:return 16;case 4:return 12;case 5:return 11;case 6:return 10;case 7:return 9;case 8:return 8;case 9:return 8;default:throw new Error("mode:"+t)}}},o.getLostPoint=function(t){for(var e=t.getModuleCount(),r=0,n=0;n<e;n++)for(var i=0;i<e;i++){for(var a=0,s=t.isDark(n,i),u=-1;u<=1;u++)if(!(n+u<0||e<=n+u))for(var h=-1;h<=1;h++)i+h<0||e<=i+h||0==u&&0==h||s==t.isDark(n+u,i+h)&&a++;5<a&&(r+=3+a-5)}for(n=0;n<e-1;n++)for(i=0;i<e-1;i++){var c=0;t.isDark(n,i)&&c++,t.isDark(n+1,i)&&c++,t.isDark(n,i+1)&&c++,t.isDark(n+1,i+1)&&c++;(0==c||4==c)&&(r+=3)}for(n=0;n<e;n++)for(i=0;i<e-6;i++)t.isDark(n,i)&&!t.isDark(n,i+1)&&t.isDark(n,i+2)&&t.isDark(n,i+3)&&t.isDark(n,i+4)&&!t.isDark(n,i+5)&&t.isDark(n,i+6)&&(r+=40);for(i=0;i<e;i++)for(n=0;n<e-6;n++)t.isDark(n,i)&&!t.isDark(n+1,i)&&t.isDark(n+2,i)&&t.isDark(n+3,i)&&t.isDark(n+4,i)&&!t.isDark(n+5,i)&&t.isDark(n+6,i)&&(r+=40);for(var l=0,i=0;i<e;i++)for(n=0;n<e;n++)t.isDark(n,i)&&l++;return r+=10*(Math.abs(100*l/e/e-50)/5)},o.stringToBytes=r.stringToBytes;var a={};a.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,16,55,25],[30,46,16,2,47,17],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,147,117,4,148,118],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,145,115,13,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,25,46,16],[4,145,115,14,146,116],[29,74,46,1,75,47],[44,54,24,1,55,25],[23,45,15,28,46,16],[6,145,115,14,146,116],[6,74,46,28,75,47],[46,54,24,1,55,25],[2,45,15,49,46,16],[6,145,115,14,146,116],[6,74,46,31,75,47],[45,54,24,2,55,25],[4,45,15,51,46,16],[8,145,116,13,146,117],[13,74,46,25,75,47],[48,54,24,1,55,25],[4,45,15,54,46,16],[9,145,116,16,146,117],[16,74,46,22,75,47],[50,54,24,2,55,25],[10,45,15,57,46,16],[12,145,116,15,146,117],[12,74,46,26,75,47],[36,54,24,14,55,25],[20,45,15,61,46,16]],a.getRSBlocks=function(t,r){var n=function(t,r){switch(r){case e.L:return a.RS_BLOCK_TABLE[4*(t-1)+0];case e.M:return a.RS_BLOCK_TABLE[4*(t-1)+1];case e.Q:return a.RS_BLOCK_TABLE[4*(t-1)+2];case e.H:return a.RS_BLOCK_TABLE[4*(t-1)+3];default:return}}(t,r);if(void 0===n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+r);for(var i=n.length/3,o=[],s=0;s<i;s++)for(var u=n[3*s+0],h=n[3*s+1],c=n[3*s+2],l=0;l<u;l++)o.push({totalCount:h,dataCount:c});return o};function s(){}function u(){this.buffer=new Array,this.length=0}u.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;r<e;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};function h(){}function c(t,e){if(void 0===t.length)throw new Error(t.length+"/"+e);var r=0;for(;r<t.length&&0==t[r];)r++;this.num=new Array(t.length-r+e);for(var n=0;n<t.length-r;n++)this.num[n]=t[n+r]}c.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),r=0;r<this.getLength();r++)for(var i=0;i<t.getLength();i++)e[r+i]^=n.gexp(n.glog(this.get(r))+n.glog(t.get(i)));return new c(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=n.glog(this.get(0))-n.glog(t.get(0)),r=new Array(this.getLength()),i=0;i<this.getLength();i++)r[i]=this.get(i);for(i=0;i<t.getLength();i++)r[i]^=n.gexp(e+n.glog(t.get(i)));return new c(r,0).mod(t)}};var l,d,f,g=function(t,e){var r=t.getModuleCount();void 0===e&&(e=t.getModuleCount()*.02);var n=new function(t){var e,r;this.width=t,this.height=t,this.data=[[]],this.eval=function(t,n){var i;return e=Math.round(t),r=Math.round(n),(i=this.data)instanceof Window&&(i=i.document),i[e][r]}},i=[],o=new Image;return o.crossOrigin="Anonymous",o.src=e,new Promise(function(t,e){o.onload=function(){var e=document.createElement("canvas");e.width=o.width,e.height=o.height;var a=e.getContext("2d");a.drawImage(o,0,0);for(var s=a.getImageData(0,0,e.width,e.height).data,u=0;u<e.height;u++)for(var h=[],c=0;c<e.width;c++){var l=s[4*(u*e.width+c)],d=s[4*(u*e.width+c)+1],f=s[4*(u*e.width+c)+2];h.push(.2126*l+.7152*d+.0722*f<128?1:0)}n.data=h;for(u=0;u<r;u++)for(var g=[],v=0;v<r;v++)g.push(n.eval(v*o.width/r,u*o.height/r));i=g,t(i)}})},p=(l=t,d=e,f=g(l,d),Promise.all([f]).then(function(t){for(var e=0;e<l.moduleCount;e++)for(var r=0;r<l.moduleCount;r++)1==t[0][e][r]?l.modules[e][r]=!0:l.modules[e][r]=!1;return Promise.resolve()})),m=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#00FFFF","#FF00FF"],w={};w.getTypeNumber=function(){return this.typeNumber},w.makeCode=function(t){this.clear(),this.qrcode.addData(t),this.qrcode.make(),this._htOption.autoColor?this._oDrawing.draw(this.qrcode,this._htOption,!0,this.runNext.bind(this)):this._oDrawing.draw(this.qrcode,this._htOption)},w.makeCodeCallBack=function(t){this.makeCode(t)},w.clear=function(){this._oDrawing.clear()},w.runNext=function(t){this._htOption.onRenderingEnd(this._htOption,t),this.resolve()},w.makeImage=function(){return this.qrcode?this._oDrawing.makeImage():Promise.reject("Run makeCode() before makeImage()")},s.prototype.draw=function(e,r,n,i){var o=r.width,a=r.height,s=r.colorDark,u=r.colorLight,h=this.getFrame(e),c=o/h.length,l=a/h.length,d=this._el,f=document.createElement("canvas");f.width=o,f.height=a,d.appendChild(f),this.canvas=f;var g=f.getContext("2d");this.g=g,g.fillStyle=s,g.fillRect(0,0,o,a),g.fillStyle=u,this._htOption.quietZone>0&&g.fillRect(this._htOption.quietZone,this._htOption.quietZone,o-2*this._htOption.quietZone,a-2*this._htOption.quietZone);for(var v=this._htOption.quietZone/c,p=this._htOption.quietZone/l,m=0;m<h.length;m++)for(var w=0;w<h.length;w++)h[m][w]||g.clearRect(Math.round((w+v)*c),Math.round((m+p)*l),Math.ceil(c),Math.ceil(l));if(n){var E=r.logo,b=r.logoWidth,T=r.logoHeight,y=r.logoBackgroundColor,A=r.logoBackgroundTransparent;this._htOption.logo?"function"!=typeof E?this.drawImage(E,o/2-b/2,a/2-T/2,b,T,y,A,i):i(!1):i(!0)}this.g.fill()},s.prototype.getFrame=function(t){var e,r=[],n=t.getModuleCount();this._htOption.quietZone=0;var i=this._htOption.quietZone;if(i<0||i*Math.max(1,n/215)>Math.min(t.moduleCount/3,10))throw new Error("Quiet zone cannot be larger than 30% of QR code size, or larger than 10 modules. Recommended at most 4 modules.");var o=this._htOption.quietZone=Math.ceil(Math.max(0,this._htOption.quietZone));for(e=0;e<n+2*o;e++){r[e]=[];for(var a=0;a<n+2*o;a++)r[e][a]=!(o<=e&&e<n+o&&o<=a&&a<n+o&&t.isDark(e-o,a-o))}return r},s.prototype.drawImage=function(t,e,r,n,i,o,a,s){var u=document.createElement("canvas");u.width=n,u.height=i;var h=u.getContext("2d");h.fillStyle=o,h.fillRect(0,0,n,i);var c=new Image;c.crossOrigin="Anonymous",c.src=t,c.onload=function(){h.drawImage(c,0,0,n,i);var t=u.getContext("2d").getImageData(0,0,n,i).data;this.g.fillStyle=o,a||this.g.fillRect(e,r,n,i);for(var u=0;u<i;u++)for(var l=0;l<n;l++){var d=4*(u*n+l);if(t[d+3]>0){var f=m[Math.round(Math.random(m.length-1))];this.g.fillStyle=f,this.g.fillRect(e+l,r+u,1,1)}}s&&s(!0)}.bind(this)},s.prototype.clear=function(){var t=this._el;t.hasChildNodes()&&t.removeChild(t.firstChild),this.canvas=null},s.prototype.makeImage=function(){if(this.canvas){var t=document.createElement("img");if(t.src=this.canvas.toDataURL("image/png"),this._htOption.width)var e=this._htOption.width,r=this._htOption.height;else e=this.canvas.width,r=this.canvas.height;return t.width=e,t.height=r,Promise.resolve(t)}return Promise.reject("canvas not ready")},h.prototype.draw=function(t,e){var r=e.width,n=e.height,i=e.colorDark,o=e.colorLight,a=this.getFrame(t);this._el.innerHTML='<svg width="'+r+'" height="'+n+'" viewBox="0 0 '+a.length+" "+a.length+'" shape-rendering="crispEdges" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg>';var s=this._el.firstChild;s.setAttribute("fill",o),s.innerHTML+='<rect width="100%" height="100%" />';var u="";for(var h=0;h<a.length;h++)for(var c=0;c<a.length;c++)a[h][c]||(u+='<rect width="1" height="1" x="'+c+'" y="'+h+'" />');var l=document.createElementNS("http://www.w3.org/2000/svg","g");l.setAttribute("fill",i),l.innerHTML=u,s.appendChild(l)},h.prototype.getFrame=s.prototype.getFrame,h.prototype.clear=s.prototype.clear,h.prototype.makeImage=function(){if(this._el.firstChild){var t=this._el.firstChild.outerHTML,e="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(t)));if(this._htOption.width)var r=this._htOption.width,n=this._htOption.height;else r=256,n=256;var i=new Image;return i.src=e,i.width=r,i.height=n,Promise.resolve(i)}return Promise.reject("svg not ready")};var E={};return E.CorrectLevel={L:e.L,M:e.M,Q:e.Q,H:e.H},function(r,n){if(this._htOption="string"==typeof n?{text:n}:n,this._htOption)if(this._htOption.text){"object"==typeof this._htOption.text?w.call(this,this._htOption.text):(l=this._htOption.text,this.makeCode(l));var i=Object.assign({width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:E.CorrectLevel.H},this._htOption);this._htOption=i}else"object"==typeof this._htOption&&w.call(this,this._htOption);else this._htOption={};this._el="string"==typeof r?document.getElementById(r):r,this._oQRCode=null,this._oDrawing=null,this._htOption.drawer?("svg"===this._htOption.drawer?this._oDrawing=new h:this._oDrawing=new s,this._oDrawing._el=this._el,this._oDrawing._htOption=this._htOption):"CANVAS"==this._el.nodeName?this._oDrawing=new s:this._oDrawing=new h,this._oDrawing._el=this._el,this._oDrawing._htOption=this._htOption,"string"==typeof this._htOption.text&&this.makeCode(this._htOption.text),Object.assign(this,w),this.makeImage=function(){return new Promise(function(t,e){this.qrcode?t(this._oDrawing.makeImage()):e("Run makeCode() before makeImage()")}.bind(this))},this.makeCode=function(t){return this.qrcode=new E.QRCode(this._htOption.typeNumber,this._htOption.correctLevel),new Promise(function(e){this.resolve=e,this.qrcode.addData(t),this._htOption.logo?p(this.qrcode,this._htOption.logo).then(function(){this.makeCodeRun()}.bind(this)):this.makeCodeRun()}.bind(this))},this.makeCodeRun=function(){this.qrcode.make(),this._htOption.onRenderingEnd&&this._htOption.onRenderingEnd(this._htOption),this._oDrawing.draw(this.qrcode,this._htOption),this.resolve()},this.clear=function(){this._oDrawing.clear()},this._htOption.text&&this.makeCode(this._htOption.text)}}();

// ====================================================================================
// FIN DE LA BIBLIOTHÈQUE
// ====================================================================================


// --------------- Notre code applicatif ---------------

document.addEventListener('DOMContentLoaded', () => {
    const urlInput = document.getElementById('urlInput');
    const generateBtn = document.getElementById('generateBtn');
    const qrCodeContainer = document.getElementById('qrcode');
    
    // On met en cache notre objet QRCode pour ne pas le recréer à chaque fois
    let qrCode = null;

    const generateQRCode = () => {
        const url = urlInput.value.trim();
        
        if (url) {
            // On vide le conteneur avant de générer un nouveau QR Code
            qrCodeContainer.innerHTML = '';
            
            // On crée une nouvelle instance de QRCode. 
            // C'est ici que l'erreur se produisait.
            qrCode = new QRCode(qrCodeContainer, {
                text: url,
                width: 256,
                height: 256,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
        } else {
            // On vide le conteneur si l'URL est vide
            qrCodeContainer.innerHTML = '';
            alert("Veuillez entrer une URL.");
        }
    };

    // Générer le QR code au clic sur le bouton
    generateBtn.addEventListener('click', generateQRCode);

    // Optionnel : Générer le QR code en appuyant sur "Entrée"
    urlInput.addEventListener('keypress', (event) => {
        if (event.key === 'Enter') {
            generateQRCode();
        }
    });
});
